#!/bin/sh

unset _JAVA_OPTIONS
DEVEL_DIR="/home/max/devel/macros-kotlin"
ARTIFACT_DIR="${DEVEL_DIR}/out/artifacts"
LIB_DIR="${DEVEL_DIR}/libs"



#PROFILE="-agentpath:/opt/yourkit/bin/linux-x86-64/libyjpagent.so=exceptions=disable,delay=10000"
MAINCLASS=com.machfour.macros.linux.LinuxMain

# AOT things
#"-XX:+PrintAOT"
#java -XX:AOTLibrary=${DEVEL_DIR}/macros.so:${DEVEL_DIR}/macros-libs.so -enableassertions -cp "$CLASSPATH" ${MAINCLASS} "$@"

# show class loading timing:
# -verbose:class 

# log touched methods for use with AOT
#     -XX:+UnlockDiagnosticVMOptions \
#     -XX:+LogTouchedMethods \
#     -XX:+PrintTouchedMethodsAtExit 

archlinux-java-run --min 13 -- -enableassertions \
	-cp "${ARTIFACT_DIR}/macros_kotlin_main_jar/macros-kotlin.main.jar" \
    -XX:+UnlockExperimentalVMOptions \
    -XX:AOTLibrary=${DEVEL_DIR}/macros-touched-methods.so \
    ${MAINCLASS} "$@"
